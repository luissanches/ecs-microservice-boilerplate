FROM mhart/alpine-node:15

ENV NODE_ENV=production
ENV PORT=3001
ENV AUTH_ENABLED=true
ENV JWT_SECRET=AIzaSyDSkaABqe-regnetgQ9HK8KlIdEqFnIbkk 
ENV JWT_EXPIRES=1d
ENV MONGO_DB_ADDRESS=localhost
ENV MONGO_DB_PORT=27017
ENV MONGO_DB_AUTHMECHANISM=SCRAM-SHA-1
ENV MONGO_DB_AUTHSOURCE=admin
ENV MONGO_DB_CONNECTTIMEOUTMS=500000
ENV MONGO_DB_CONNECTION_RETRIES=200
ENV MONGO_DB_SLEEP_CONNECTION_RETRY=600000
ENV MONGO_DB_MAXPOOLSIZE=5
ENV MONGO_DB_USER=OneEdgeDBUser
ENV MONGO_DB_PWS=OneEdgeDBPWS
ENV MONGO_DB_NAME=OneEdge_Core
ENV CRYPT_SALT=7
ENV LOCALE=en-US
ENV TIME_ZONE=America/Chicago
ENV LOGGER_PATH=shared_data/logs/application.log

EXPOSE ${PORT}

WORKDIR /app/microservices/service/

COPY "microservices/billing" .
COPY "common/" "/app/common/"

RUN npm install --production

RUN rm -rf Dockerfile

CMD [ "npm", "start" ]
